#include <PRIZM.h>  // Include PRIZM Library
PRIZM prizm;

//variables
int turnNumber = 0;

void setup() {
prizm.PrizmBegin(); // Initiates the PRIZM controller

}

void loop() {

if (turnNumber == 0){
  prizm.setMotorPowers(25,-25);

  if(prizm.readLineSensor(4) == 1){
    prizm.setMotorPowers(125,125);

    delay(1000);
    
    prizm.resetEncoders();
    prizm.setMotorDegrees(200,420,-200,-420);
    while (prizm.readMotorBusy(1)==1){}
    prizm.resetEncoders();    
    prizm.setMotorDegree(1,200,13 00);
    while (prizm.readMotorBusy(1)==1){}

     prizm.resetEncoders();
     turnNumber=turnNumber+1;
  }
}

if (turnNumber==1){
  prizm.setMotorPowers(50,-50);

  if(prizm.readSonicSensorCM(2)==6){
    prizm.setMotorPowers(125,125);
  prizm.resetEncoders();

    prizm.setMotorDegrees(200,711,200,711);
    while (prizm.readMotorBusy(1)==1){}
  prizm.resetEncoders();

    turnNumber=turnNumber+1;
  }
}
if (turnNumber==2){

  prizm.setMotorPowers(50,-50);

  if(prizm.readSonicSensorCM(2)==15){
    prizm.setMotorPowers(125,125);
   
    prizm.resetEncoders();
    prizm.setMotorDegrees(200,1425,0,0);
    while (prizm.readMotorBusy(1)==1){}
    prizm.resetEncoders();
    turnNumber=turnNumber+1;
 
  }
} 

if (turnNumber==3){

  prizm.setMotorPowers(50,-50);

  if(prizm.readSonicSensorCM(2)==6){
    prizm.setMotorPowers(125,125);
   
    prizm.resetEncoders();
    prizm.setMotorDegrees(-200,-715,-200,-715);
    while (prizm.readMotorBusy(1)==1){} 
    prizm.resetEncoders();
    turnNumber=turnNumber+1;
 
  }
} 


if (turnNumber==4){

  prizm.setMotorPowers(50,-50);

  if(prizm.readSonicSensorCM(2)==6 ){
    prizm.setMotorPowers(125,125);
   
    prizm.resetEncoders();
    prizm.setMotorDegrees(-200,-800,-200,-800);
    while (prizm.readMotorBusy(1)==1){}
    prizm.resetEncoders();
    turnNumber=turnNumber+1;
 
  }
} 


if (turnNumber==5){

  prizm.setMotorPowers(50,-50);

  if(prizm.readSonicSensorCM(2)==5 ){
    prizm.setMotorPowers(125,125);
   
    prizm.resetEncoders();
    prizm.setMotorDegrees(200,715,200,715);
    while (prizm.readMotorBusy(1)==1){}
    prizm.resetEncoders();
 
    prizm.setMotorDegrees(400,1500,-400,-1500);
    while (prizm.readMotorBusy(1)==1){}
    prizm.resetEncoders();
    turnNumber=turnNumber+1;
 
  }
}

if (turnNumber==6){

  // beam reflected, no line detected
  if(prizm.readLineSensor(4) == 0){prizm.setMotorPowers(125,-15); prizm.setRedLED(LOW);}  

  // no relected beam, line detected
  if(prizm.readLineSensor(4) == 1){prizm.setMotorPowers(15,125); prizm.setRedLED(HIGH);} 

  if (prizm.readSonicSensorCM(2)==20 ){


    turnNumber=turnNumber+1;
  }

if (turnNumber==7){

  prizm.setMotorPower(0,125);
  prizm.setMotorPower(1,125);
  delay(10000);
 prizm.resetEncoders();
 prizm.setMotorDegrees(200,3000,-200,-3000);

    turnNumber=turnNumber+1;
  }
  
}
}
